{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/PRO-BLADE/Github/RateYourBarber/web/lib/adapters.ts"],"sourcesContent":["// web/lib/adapters.ts\n// Central adapters to convert API shapes to UI shapes\n\nexport type UiBarber = {\n  id: string | number;\n  name: string;\n  shop: string;\n  distance: string;\n  trust: number;\n  specialties: any[];\n  price: string;\n  thumb: string;\n};\n\nexport function mapApiBarberToUi(b: any): UiBarber {\n  // DB-backed barber\n  if (b && (b.trust_score || b.thumbnail_url || b.distance_m !== undefined)) {\n    const trustVal = b.trust_score ? (typeof b.trust_score.value === 'number' ? b.trust_score.value : Number(b.trust_score.value)) : 0;\n    return {\n      id: b.id,\n      name: b.name || '',\n      shop: (b.primary_location && b.primary_location.formatted_address) || b.shop || '',\n      distance: b.distance_m ? `${(b.distance_m/1609).toFixed(1)} mi` : (b.distance || ''),\n      trust: Number.isFinite(trustVal) ? trustVal : 0,\n      specialties: b.top_tags || b.specialties || [],\n      price: b.price || '$$?',\n      thumb: b.thumbnail_url || b.image_url || b.thumb || '',\n    };\n  }\n\n  // Yelp-like result\n  return {\n    id: b.id,\n    name: b.name || '',\n    shop: b.address || '',\n    distance: b.distance_m ? `${(b.distance_m/1609).toFixed(1)} mi` : (b.distance || ''),\n    trust: Math.min(100, Math.round((b.rating || 0) / 5 * 100)),\n    specialties: b.categories || [],\n    price: b.price || '$$?',\n    thumb: b.image_url || '',\n  };\n}\n"],"names":[],"mappings":"AAAA,sBAAsB;AACtB,sDAAsD;;;;;AAa/C,SAAS,iBAAiB,CAAM;IACrC,mBAAmB;IACnB,IAAI,KAAK,CAAC,EAAE,WAAW,IAAI,EAAE,aAAa,IAAI,EAAE,UAAU,KAAK,SAAS,GAAG;QACzE,MAAM,WAAW,EAAE,WAAW,GAAI,OAAO,EAAE,WAAW,CAAC,KAAK,KAAK,WAAW,EAAE,WAAW,CAAC,KAAK,GAAG,OAAO,EAAE,WAAW,CAAC,KAAK,IAAK;QACjI,OAAO;YACL,IAAI,EAAE,EAAE;YACR,MAAM,EAAE,IAAI,IAAI;YAChB,MAAM,AAAC,EAAE,gBAAgB,IAAI,EAAE,gBAAgB,CAAC,iBAAiB,IAAK,EAAE,IAAI,IAAI;YAChF,UAAU,EAAE,UAAU,GAAG,GAAG,CAAC,EAAE,UAAU,GAAC,IAAI,EAAE,OAAO,CAAC,GAAG,GAAG,CAAC,GAAI,EAAE,QAAQ,IAAI;YACjF,OAAO,OAAO,QAAQ,CAAC,YAAY,WAAW;YAC9C,aAAa,EAAE,QAAQ,IAAI,EAAE,WAAW,IAAI,EAAE;YAC9C,OAAO,EAAE,KAAK,IAAI;YAClB,OAAO,EAAE,aAAa,IAAI,EAAE,SAAS,IAAI,EAAE,KAAK,IAAI;QACtD;IACF;IAEA,mBAAmB;IACnB,OAAO;QACL,IAAI,EAAE,EAAE;QACR,MAAM,EAAE,IAAI,IAAI;QAChB,MAAM,EAAE,OAAO,IAAI;QACnB,UAAU,EAAE,UAAU,GAAG,GAAG,CAAC,EAAE,UAAU,GAAC,IAAI,EAAE,OAAO,CAAC,GAAG,GAAG,CAAC,GAAI,EAAE,QAAQ,IAAI;QACjF,OAAO,KAAK,GAAG,CAAC,KAAK,KAAK,KAAK,CAAC,CAAC,EAAE,MAAM,IAAI,CAAC,IAAI,IAAI;QACtD,aAAa,EAAE,UAAU,IAAI,EAAE;QAC/B,OAAO,EAAE,KAAK,IAAI;QAClB,OAAO,EAAE,SAAS,IAAI;IACxB;AACF"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/PRO-BLADE/Github/RateYourBarber/web/pages/barber/%5Bid%5D.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useRouter } from 'next/router';\nimport { mapApiBarberToUi, UiBarber } from '../../lib/adapters';\n\nexport default function BarberProfilePage(): JSX.Element {\n  const router = useRouter();\n  const { id } = router.query;\n  const [barberRaw, setBarberRaw] = useState<any | null>(null);\n  const [barber, setBarber] = useState<UiBarber | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!id) return;\n    async function load() {\n      setLoading(true);\n      setError(null);\n      try {\n        const apiBase = process.env.NEXT_PUBLIC_API_URL || '';\n        const res = await fetch(`${apiBase}/api/search?term=barber&location=`);\n        if (!res.ok) throw new Error(`search failed: ${res.status}`);\n        const items = await res.json();\n        const found = items.find((b: any) => String(b.id) === String(id));\n        if (!found) {\n          setError('Barber not found');\n          setBarberRaw(null);\n          setBarber(null);\n        } else {\n          setBarberRaw(found);\n          setBarber(mapApiBarberToUi(found));\n        }\n      } catch (err: any) {\n        setError(err.message || String(err));\n        setBarberRaw(null);\n        setBarber(null);\n      } finally {\n        setLoading(false);\n      }\n    }\n    load();\n  }, [id]);\n\n  if (loading) return <div>Loading profile...</div>;\n  if (error) return <div>Error: {error}</div>;\n  if (!barberRaw || !barber) return <div>No barber found</div>;\n\n  // Determine verification status using a few possible API field names\n  const barberVerified = barberRaw.verified === true || barberRaw.is_verified === true || !!barberRaw.verified_at || barberRaw.status === 'verified';\n  const shop = barberRaw.primary_location || barberRaw.shop || null;\n  const shopVerified = !!shop && (shop.verified === true || shop.is_verified === true || !!shop.verified_at || shop.status === 'verified');\n\n  const hasBusinessProfile = barberRaw.business_profile === true || barberRaw.has_business_profile === true || !!barberRaw.business_profile_id;\n\n  const creditsBarber = Number(barberRaw.credits || barberRaw.reward_points || 0);\n  const creditsShop = Number(shop && (shop.credits || shop.reward_points) ? (shop.credits || shop.reward_points) : 0);\n  const combinedCredits = creditsBarber + creditsShop;\n\n  return (\n    <main style={{ padding: 20 }}>\n      <h1>{barber.name}</h1>\n      <div style={{ display: 'flex', gap: 12, alignItems: 'center' }}>\n        {barber.thumb ? <img src={barber.thumb} alt={`${barber.name} thumb`} style={{ width: 140, height: 140, objectFit: 'cover', borderRadius: 6 }} /> : null}\n        <div>\n          <p style={{ margin: 0 }}><strong>Shop:</strong> {barber.shop || 'Independent'}</p>\n          <p style={{ margin: 0 }}><strong>Distance:</strong> {barber.distance}</p>\n          <p style={{ margin: 0 }}><strong>Trust:</strong> {barber.trust}</p>\n        </div>\n      </div>\n\n      <section style={{ marginTop: 18 }}>\n        <h2>Verification</h2>\n        <p>\n          <strong>Barber verified:</strong> {barberVerified ? 'Yes' : 'No'}\n          {' '}\n          <strong>Shop verified:</strong> {shopVerified ? 'Yes' : 'No'}\n        </p>\n        <p>\n          <strong>Business profile:</strong> {hasBusinessProfile ? 'Exists' : 'None'}\n        </p>\n      </section>\n\n      <section style={{ marginTop: 18 }}>\n        <h2>Credits</h2>\n        <p><strong>Barber credits:</strong> {creditsBarber}</p>\n        <p><strong>Shop credits:</strong> {creditsShop}</p>\n        <p><strong>Combined credits:</strong> {combinedCredits}</p>\n        <p style={{ color: '#555' }}>If both the barber and the shop are verified, the barber can earn credits from both pages.</p>\n      </section>\n\n      <section style={{ marginTop: 18 }}>\n        <h2>Actions</h2>\n        {!hasBusinessProfile && (\n          <button onClick={() => alert('Claim Business Profile flow not yet implemented')} style={{ padding: '8px 12px' }}>\n            Claim Business Profile\n          </button>\n        )}\n        {hasBusinessProfile && (\n          <button onClick={() => alert('Manage business profile (not implemented)')} style={{ padding: '8px 12px' }}>\n            Manage Business Profile\n          </button>\n        )}\n      </section>\n\n      {shop && (\n        <section style={{ marginTop: 18 }}>\n          <h2>Shop</h2>\n          <p><strong>Name:</strong> {shop.name || shop.formatted_address || barber.shop}</p>\n          <p><strong>Verified:</strong> {shopVerified ? 'Yes' : 'No'}</p>\n          {shop.id ? (\n            <p><a href={`/shop/${shop.id}`}>Open shop page</a></p>\n          ) : null}\n        </section>\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}