{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/PRO-BLADE/Github/RateYourBarber/web/lib/location.ts"],"sourcesContent":["export type Coords = { latitude: number; longitude: number };\nconst KEY = 'ryb:lastLocation';\n\nexport function cacheLocation(c: Coords) {\n  if (typeof window === 'undefined') return;\n  try { localStorage.setItem(KEY, JSON.stringify(c)); } catch (e) {}\n}\n\nexport function getCachedLocation(): Coords | null {\n  if (typeof window === 'undefined') return null;\n  try {\n    const v = localStorage.getItem(KEY);\n    return v ? JSON.parse(v) : null;\n  } catch (e) { return null; }\n}\n\nexport function requestLocation(timeout = 10000): Promise<Coords> {\n  return new Promise((resolve, reject) => {\n    if (typeof navigator === 'undefined' || !navigator.geolocation) {\n      return reject(new Error('Geolocation not available'));\n    }\n    const onSuccess = (pos: GeolocationPosition) => {\n      const coords = { latitude: pos.coords.latitude, longitude: pos.coords.longitude };\n      try { cacheLocation(coords); } catch (e) {}\n      resolve(coords);\n    };\n    const onError = (err: GeolocationPositionError) => reject(err);\n    const id = navigator.geolocation.getCurrentPosition(onSuccess, onError, { maximumAge: 60_000, timeout });\n    // no cleanup required here; caller may ignore\n  });\n}\n\n// Optional reverse geocode via OpenStreetMap Nominatim (client-side)\nexport async function reverseGeocode(lat: number, lon: number): Promise<string | null> {\n  // Prefer server-side geocoding via `/api/geocode` so the Google API key can remain secret.\n  try {\n    if (typeof window === 'undefined') {\n      return null;\n    }\n    const base = '';\n    const url = new URL(`/api/geocode?lat=${encodeURIComponent(String(lat))}&lon=${encodeURIComponent(String(lon))}`, window.location.origin || base || window.location.href);\n    const res = await fetch(url.toString(), { headers: { Accept: 'application/json' } });\n    if (!res.ok) return null;\n    const j = await res.json();\n    return j && j.address ? j.address : null;\n  } catch (e) {\n    return null;\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AACA,MAAM,MAAM;AAEL,SAAS,cAAc,CAAS;IACrC,wCAAmC;;;AAErC;AAEO,SAAS;IACd,wCAAmC,OAAO;;;AAK5C;AAEO,SAAS,gBAAgB,UAAU,KAAK;IAC7C,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,IAAI,OAAO,cAAc,eAAe,CAAC,UAAU,WAAW,EAAE;YAC9D,OAAO,OAAO,IAAI,MAAM;QAC1B;QACA,MAAM,YAAY,CAAC;YACjB,MAAM,SAAS;gBAAE,UAAU,IAAI,MAAM,CAAC,QAAQ;gBAAE,WAAW,IAAI,MAAM,CAAC,SAAS;YAAC;YAChF,IAAI;gBAAE,cAAc;YAAS,EAAE,OAAO,GAAG,CAAC;YAC1C,QAAQ;QACV;QACA,MAAM,UAAU,CAAC,MAAkC,OAAO;QAC1D,MAAM,KAAK,UAAU,WAAW,CAAC,kBAAkB,CAAC,WAAW,SAAS;YAAE,YAAY;YAAQ;QAAQ;IACtG,8CAA8C;IAChD;AACF;AAGO,eAAe,eAAe,GAAW,EAAE,GAAW;IAC3D,2FAA2F;IAC3F,IAAI;QACF,wCAAmC;YACjC,OAAO;QACT;;;QACA,MAAM;QACN,MAAM;QACN,MAAM;QAEN,MAAM;IAER,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF"}}]
}